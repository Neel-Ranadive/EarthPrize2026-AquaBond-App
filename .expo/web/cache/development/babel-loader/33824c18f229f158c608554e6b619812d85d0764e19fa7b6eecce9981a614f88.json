{"ast":null,"code":"export function rgbToLab(r, g, b) {\n  var R = r / 255;\n  var G = g / 255;\n  var B = b / 255;\n  R = R <= 0.04045 ? R / 12.92 : Math.pow((R + 0.055) / 1.055, 2.4);\n  G = G <= 0.04045 ? G / 12.92 : Math.pow((G + 0.055) / 1.055, 2.4);\n  B = B <= 0.04045 ? B / 12.92 : Math.pow((B + 0.055) / 1.055, 2.4);\n  var X = R * 0.4124564 + G * 0.3575761 + B * 0.1804375;\n  var Y = R * 0.2126729 + G * 0.7151522 + B * 0.072175;\n  var Z = R * 0.0193339 + G * 0.1191920 + B * 0.9503041;\n  var Xn = 0.95047,\n    Yn = 1.0,\n    Zn = 1.08883;\n  var x = X / Xn,\n    y = Y / Yn,\n    z = Z / Zn;\n  function f(t) {\n    return t > 0.008856 ? Math.cbrt(t) : 7.787 * t + 16 / 116;\n  }\n  var fx = f(x),\n    fy = f(y),\n    fz = f(z);\n  var L = 116 * fy - 16;\n  var a = 500 * (fx - fy);\n  var b2 = 200 * (fy - fz);\n  return {\n    L: L,\n    a: a,\n    b: b2\n  };\n}\nexport function labToPh(lab) {\n  try {\n    var model = require(\"./calibration/model.json\");\n    if (model && model.intercept !== undefined && model.coefs) {\n      var intercept = model.intercept,\n        coefs = model.coefs;\n      var _phEstimate = intercept + (coefs.L || 0) * lab.L + (coefs.a || 0) * lab.a + (coefs.b || 0) * lab.b;\n      return Math.max(0, Math.min(14, Number(_phEstimate.toFixed(2))));\n    }\n  } catch (e) {}\n  var phEstimate = 7 + 0.01 * (lab.L - 50) - 0.02 * lab.a + 0.015 * lab.b;\n  return Math.max(0, Math.min(14, Number(phEstimate.toFixed(2))));\n}","map":{"version":3,"names":["rgbToLab","r","g","b","R","G","B","Math","pow","X","Y","Z","Xn","Yn","Zn","x","y","z","f","t","cbrt","fx","fy","fz","L","a","b2","labToPh","lab","model","require","intercept","undefined","coefs","phEstimate","max","min","Number","toFixed","e"],"sources":["C:/Users/Neel/Downloads/EarthPrize26-HOLDER/EarthPrize2026-AquaBond-App/colorUtils.ts"],"sourcesContent":["// Basic color conversion utilities\r\nexport function rgbToLab(r: number, g: number, b: number) {\r\n  // normalize\r\n  let R = r / 255;\r\n  let G = g / 255;\r\n  let B = b / 255;\r\n  // inverse gamma\r\n  R = R <= 0.04045 ? R / 12.92 : Math.pow((R + 0.055) / 1.055, 2.4);\r\n  G = G <= 0.04045 ? G / 12.92 : Math.pow((G + 0.055) / 1.055, 2.4);\r\n  B = B <= 0.04045 ? B / 12.92 : Math.pow((B + 0.055) / 1.055, 2.4);\r\n  // sRGB D65\r\n  const X = R * 0.4124564 + G * 0.3575761 + B * 0.1804375;\r\n  const Y = R * 0.2126729 + G * 0.7151522 + B * 0.072175;\r\n  const Z = R * 0.0193339 + G * 0.1191920 + B * 0.9503041;\r\n  // normalize by D65 white\r\n  const Xn = 0.95047,\r\n    Yn = 1.0,\r\n    Zn = 1.08883;\r\n  let x = X / Xn,\r\n    y = Y / Yn,\r\n    z = Z / Zn;\r\n  function f(t: number) {\r\n    return t > 0.008856 ? Math.cbrt(t) : (7.787 * t + 16 / 116);\r\n  }\r\n  const fx = f(x),\r\n    fy = f(y),\r\n    fz = f(z);\r\n  const L = 116 * fy - 16;\r\n  const a = 500 * (fx - fy);\r\n  const b2 = 200 * (fy - fz);\r\n  return { L, a, b: b2 };\r\n}\r\n\r\n// Placeholder mapping from Lab -> pH (user will replace with calibrated model)\r\nexport function labToPh(lab: { L: number; a: number; b: number }) {\r\n  // If a calibration model exists, use its linear coefficients.\r\n  try {\r\n    // dynamic require so mobile bundlers include JSON if present\r\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\r\n    const model = require(\"./calibration/model.json\");\r\n    if (model && model.intercept !== undefined && model.coefs) {\r\n      const { intercept, coefs } = model; // coefs: {L, a, b}\r\n      const phEstimate = intercept + (coefs.L || 0) * lab.L + (coefs.a || 0) * lab.a + (coefs.b || 0) * lab.b;\r\n      return Math.max(0, Math.min(14, Number(phEstimate.toFixed(2))));\r\n    }\r\n  } catch (e) {\r\n    // no model file â€” fall back to toy mapping below\r\n  }\r\n  const phEstimate = 7 + 0.01 * (lab.L - 50) - 0.02 * lab.a + 0.015 * lab.b;\r\n  return Math.max(0, Math.min(14, Number(phEstimate.toFixed(2))));\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}